Make tables with auto-auto-annotation; also make files in separate category
Generate L3 aggregation
Add auto-annotation to Loom
Put auto-auto-annotation in plots
Merging non-neurons

Gene-side clustering

Plot gene names for last cluster right-justified
Redraw t-SNE using cluster ordering as initial layout (in circle)
level 3 analysis
    merge all data
    aggregate all data
    dendrogram based on all clusters
        - using trinarization score distance locally?
        - using enriched genes on enrichment score
    export trinarization table for all clusters
resample to compute cluster stability
make sure layers are always merged

order the rows of the matrix by maximum enrichment (below marker table)
make Loom heatmap same color as PDF
limit the size of clusters to 10% of all cells in second round of clustering

x Merge clusters based on Ward linkage clustering
x try less steep scales for k (1/k^p) with p = 2, 3, 4, ...
x Export CSV for Patrik
x Organize the level 2 analysis to avoid redundant computations
x Use max 10-20% of all cells for enrichment score
x Do this also for gene selection in preliminary clustering
x min-pts 10 if <3000 cells, 20 if <20000, else 100
x epsilon_pct 65
x back-port multiscale KNN to level 1
x Compute P value for enrichment score, correct FDR


# projects Gioele

## Transcriptional velocity

-> get all the data reanalyzed and represented as 4-layer Loom files, float16:
    1. Sum of all (default layer)
    2. Unspliced ("unspliced")
    3. Spliced ("spliced")
    4. Ambiguous ("ambiguous")
